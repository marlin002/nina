<% content_for :title, "Benina" %>

<div class="scrapes-header">
  <h1>Benina</h1>
  <p class="subtitle">
    S칬k enkelt i alla AFSar!
  </p>
  
  <div class="search-inline">
    <%= form_with url: search_scrapes_path, method: :get, local: true, class: "search-form" do %>
      <%= text_field_tag :q, params[:q], placeholder: "S칬k paragrafer (ren text)", class: "input-text" %>
      <%= hidden_field_tag :context, 50 %>
      <%= submit_tag "S칬k", class: "btn btn-primary" %>
    <% end %>
  </div>
  
  <div class="stats-summary">
    <div class="stat-item">
      <span class="stat-number"><%= @stats[:total_scrapes] %></span>
      <span class="stat-label">F칬reskrifter</span>
    </div>
    <div class="stat-item">
      <span class="stat-number"><%= @stats[:total_articles] %></span>
      <span class="stat-label">Paragrafer</span>
    </div>
    <div class="stat-item">
      <span class="stat-number"><%= @stats[:total_general_recommendations] %></span>
      <span class="stat-label">Allm칛nna r친d</span>
    </div>
  </div>
  <% if @stats[:last_updated] %>
    <p class="last-updated">
      <em>Senast uppdaterad: <%= @stats[:last_updated].strftime("%Y-%m-%d kl %H:%M") %></em>
    </p>
  <% end %>
</div>

<div class="regulation-grid">
  <% @scrapes.each do |scrape| %>
    <div class="regulation-card">
      <div class="regulation-header">
        <h3><%= regulation_name(scrape.source.url) %></h3>
        <div class="regulation-stats">
          <span class="stat">游늶 <%= article_count(scrape.raw_html) %> paragrafer</span>
          <span class="stat">游눠 <%= general_recommendation_count(scrape.raw_html) %> allm칛nna r친d</span>
        </div>
      </div>
      
      
      <div class="regulation-subject">
        <p class="subject-text">
          <%= regulation_title_subject(scrape.title) %>
        </p>
      </div>
      
      <div class="regulation-preview">
        <p class="preview-text">
          <%= section_preview(scrape.raw_html, 200) %>
        </p>
      </div>
      
      <div class="regulation-actions">
        <%= link_to "Visa", raw_scrape_path(scrape), class: "btn btn-primary", target: "_blank" %>
        <%= link_to "K칛lla", scrape.source.url, class: "btn btn-outline", target: "_blank" %>
      </div>
    </div>
  <% end %>
</div>

<% if @scrapes.empty? %>
  <div class="empty-state">
    <h3>Inget inh칛mtat inneh친ll tillg칛ngligt</h3>
    <p>K칬r scraping-jobben f칬r att fylla sidan med inneh친ll.</p>
    <pre><code>rails scrape:all</code></pre>
  </div>
<% end %>